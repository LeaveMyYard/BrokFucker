# Rest API для BrokFucker (08.03.2020)

## Общая информация
* Адрес сайта (пока что, локальный): **https://127.0.0.1:5000/api/v1/**
* Все запросы возвращают JSON.

## HTTP Return Codes

* HTTP `4XX` возвращается при не правильном запросе;
  ошибка на стороне отправителя.
* HTTP `429` возвращается в случае, если превышено количество запросов.
* HTTP `418` возвращается в случае, когда ip адресс получил бан, после того как продолжил отправлять запросы после кода `429`.
* HTTP `5XX` возвращается в случае, если ошибка находится на серверной стороне.

## Error Codes
* Почти все запросы могут завершиться ошибкой:

Пример ошибки:
```javascript
{
  "code": -1121,
  "msg": "Invalid symbol."
}
```
* Описание всех ошибок лежит в отдельном файле: [Errors Codes](./errors.md).

## Общая информация по запросам
* Все параметры отправляются  `query string` with content type `application/json`.
* Запросы, не требующие параметров, не обрабатывают входящие данные.
* Параметры могут находиться в любом порядке.

## Примеры запросов
* Пример запроса используя коммандную стоку Windows и `curl`.

### Пример для POST register
* **request json:** {'email': 'test@gmail.com', 'password': 'qwerty1312'}

* **curl command:**

    ```
    [windows] curl -i -H "Content-Type: application/json" -X POST -d "{""email"":""test@gmail.com"", ""password"":""qwerty1312""}"  http://127.0.0.1:5000/api/v1/register
    ```

Заметьте, что реальное тело запроса - `'{"email":"test@gmail.com", "password":"qwerty1312"}'`.

Стандартная консоль Windows (в отличии от Bash), использует только двойные ковычки для указания строки, 
а символ " внутри строки должен экранироваться еще одной ковычкой.

### Example for GET /api/v1/getUserData with authentification

Некоторые запросы требуют аутентификации.

Для этого, требуется переслать данные логина и пароля в шапке запроса.

Существует несколько уровней доступа запроса: **public**, **user**, **moderator** и **administrator**.

В случае отсутствия необходимого уровня доступа, в ответе вернется ошибка.

* **request json:** NONE

* **curl command:**

    ```
    [windows] curl -u test@gmail.com:qwerty1312 -i http://localhost:5000/api/v1/getUserData
    ```

  
# Список всех запросов
## Публичные запросы
* ```(public) GET /api/v1/ping```
  * [Проверяет соединение с сервером.](#Проверка-соединения)

## Запросы регистрации
* ```(public) POST /api/v1/register```
  * [Начинает процесс регистрации нового пользователя.](#Создать-новый-аккаунт)
* ```(public) GET /api/v1/register/verify/<string:verification_hash>```
  * [Подтверждает регистрацию.](#Подтвердить-регистрацию)

## Запросы пользователя
### Данные
* ```(user) GET /api/v1/user```
  * [Информация о текущем пользователе.](#Информация-о-текущем-пользователе)
* ```(user) PUT /api/v1/user```
  * [Обновить данные текущего пользователя.](#Обновить-данные-текущего-пользователя)
* ```(user) PUT /api/v1/user/password```
  * [Запрос на изменение пароля пользователя.](#Запрос-на-изменение-пароля-пользователя)
* ```(public) GET /api/v1/lots/password/verification/<string:code>```
  * [Подтвердить код изменения пароля.](#Подтвердить-код-изменения-пароля)
* ```(user) GET /api/v1/user/restore/<string:email>```
  * [Восстановить пароль.](#Восстановить-пароль)
* ```(public) GET /api/v1/user/restore/verify/<string:code>```
  * [Подтвердить восстановление пароля.](#Подтвердить-восстановление-пароля)
### Аватар
* ```(user) GET /api/v1/user/avatar```
  * [Ссылка на аватар текущего пользователя.](#Ссылка-на-аватар-текущего-пользователя)
* ```(user) POST /api/v1/user/avatar```
  * [Загрузить новый аватар.](#Загрузить-новый-аватар)
* ```(user) DELETE /api/v1/user/avatar```
  * [Удалить текущий аватар.](#Удалить-текущий-аватар)
  
## Лоты
### Общее
* ```(public) GET /api/v1/lots/settings```
  * [Информация о доступных значениях различных полей лотов.](#Информация-о-доступных-значениях-различных-полей-лотов)
* ```(public) GET /api/v1/lots```
  * [Получить все публичные лоты.](#Получить-все-публичные-лоты)
* ```(public) GET/POST /api/v1/lots/approved```
  * [Копия GET /api/v1/lots.](#Копия-GET-/api/v1/lots)
* ```(user) POST /api/v1/lots```
  * [Создать новый лот.](#Создать-новый-лот)
* ```(public) GET /api/v1/lots/<int:id>```
  * [Получить данные о лоте.](#Получить-данные-о-лоте)
* ```(user) PUT /api/v1/lots/<int:id>```
  * [Обновить данные лота.](#Обновить-данные-лота)
* ```(user) POST /api/v1/lots/<int:id>```
  * [Восстановить удаленный лот.](#Восстановить-удаленный-лот)
* ```(user) DELETE /api/v1/lots/<int:id>```
  * [Удалить лот.](#Удалить-лот)
* ```(user) DELETE /api/v1/lots/personal/deleted/<int:lot_id>```
  * [Полностью удалить лот.](#Полностью-удалить-лот)
* ```(public) GET /api/v1/lots/<int:id>/photos```
  * [Получить список фотографий лота.](#Получить-список-фотографий-лота)
* ```(user) POST /api/v1/lots/<int:id>/photos```
  * [Добавить лоту фотографию.](#Добавить-лоту-фотографию)
* ```(user) DELETE /api/v1/lots/<int:id>/photos/<int:photo_id>```
  * [Удалить фотографию лота.](#Удалить-фотографию-лота)
### Избранное
* ```(user) PUT /api/v1/lots/favorites/<int:lot_id>```
  * [Добавить лот в избранное.](#Добавить-лот-в-избранное)
* ```(user) DELETE /api/v1/lots/favorites/<int:lot_id>```
  * [Удалить лот из избранных.](#Удалить-лот-из-избранных)
* ```(user) GET/POST /api/v1/lots/favorites```
  * [Получить список избранных лотов.](#Получить-список-избранных-лотов)
### Свои лоты
* ```(user) GET/POST /api/v1/lots/personal```
  * [Получить список своих не занятых лотов.](#Получить-список-избранных-лотов)
* ```(user) GET/POST /api/v1/lots/personal/current```
  * [Дубликат /api/v1/lots/personal](#Получить-список-избранных-лотов)
* ```(user) GET/POST /api/v1/lots/personal/taken```
  * [Получить список своих лотов, нашедших финансирование.](#Получить-список-своих-лотов,-нашедших-финансирование)
* ```(user) GET/POST /api/v1/lots/personal/finished```
  * [Получить список своих завершенных лотов.](#Получить-список-своих-завершенных-лотов)
* ```(user) GET/POST /api/v1/lots/personal/deleted```
  * [Получить список своих удаленных лотов.](#Получить-список-своих-удаленных-лотов)
### Подписки
* ```(user) PUT /api/v1/lots/subscription/<int:id>```
  * [Подписаться на лот.](#Подписаться-на-лот)
* ```(user) DELETE /api/v1/lots/subscription/<int:id>```
  * [Убрать подписку на лот.](#Убрать-подписку-на-лот)
* ```(user) GET /api/v1/lots/subscription```
  * [Получить список лотов, на которые ты подписан.](#Получить-список-лотов,-на-которые-ты-подписан)
### Запросы
* ```(user) PUT /api/v1/lots/personal/<int:lot_id>/request/guarantee```
  * [Запросить гарантию клуба.](#Запросить-гарантию-клуба)
* ```(user) PUT /api/v1/lots/personal/<int:lot_id>/request/verify_security```
  * [Запросить подтверждение обеспечения.](#Запросить-подтверждение-обеспечения)

## Запросы модератора
### Лоты
* ```(moderator) PUT /api/v1/lots/<int:lot_id>/approve```
  * [Подтвердить лот.](#Подтвердить-лот)
* ```(moderator) PUT /api/v1/lots/<int:lot_id>/security```
  * [Подтвердить проверенное обеспечение лота.](#Подтвердить-проверенное-обеспечение-лота)
* ```(moderator) DELETE /api/v1/lots/<int:lot_id>/security```
  * [Убрать проверенное обеспечение лота.](#Убрать-проверенное-обеспечение-лота)
* ```(moderator) PUT /api/v1/lots/<int:lot_id>/guarantee```
  * [Установить гарантию клуба лоту.](#Установить-гарантию-клуба-лоту)
* ```(moderator) DELETE /api/v1/lots/<int:lot_id>/guarantee```
  * [Убрать гарантию клуба у лота.](#Убрать-гарантию-клуба-у-лота)
* ```(moderator) GET /api/v1/lots/unapproved```
  * [Получить список неподтвержденных лотов.](#Получить-список-неподтвержденных-лотов)
### Подписки
* ```(moderator) GET /api/v1/lots/subscription/approved```
  * [Получить список подтвержденных подписок.](#Получить-список-подтвержденных-подписок)
* ```(moderator) GET /api/v1/lots/subscription/unapproved```
  * [Получить список неподтвержденных подписок.](#Получить-список-неподтвержденных-подписок)
* ```(moderator) DELETE /api/v1/lots/unapproved/<int:lot_id>```
  * [Отклонить неподтвержденный лот.](#Отклонить-неподтвержденный-лот)
### Запросы
* ```(moderator) GET /api/v1/lots/requested/guarantee```
  * [Получить список лотов, запросивших гарантию клуба.](#Получить-список-лотов,-запросивших-гарантию-клуба)
* ```(moderator) GET /api/v1/lots/requested/security_verification```
  * [Получить список лотов, запросивших проверку обеспечения.](#Получить-список-лотов,-запросивших-проверку-обеспечения)
* ```(moderator) GET /api/v1/lots/subscription/<string:id>/approve```
  * [Подтвердить неподтвержденную подписку.](#Подтвердить-неподтвержденную-подписку)
* ```(moderator) GET /api/v1/lots/subscription/<string:id>/unapprove```
  * [Снять подтверждение подписки.](#Снять-подтверждение-подписки)
* ```(moderator) DELETE /api/v1/lots/subscription/<string:id>```
  * [Удалить неподтвержденную подписку.](#Удалить-неподтвержденную-подписку)
* ```(moderator) GET /api/v1/lots/subscription/<string:id>/finish```
  * [Закончить подтвержденную подписку.](#Закончить-подтвержденную-подписку)
### Архив
* ```(moderator) GET/POST /api/v1/lots/archive```
  * [Получить список архивных лотов.](#Получить-список-архивных-подписок)
* ```(moderator) GET /api/v1/lots/archive/<int:lot_id>```
  * [Посмотреть историю архивного лота.](#Посмотреть-историю-архивной-подписки)

## Запросы администратора
* ```(administrator) PUT /api/v1/user/<string:email>/moderator```
  * [Добавить права модератора.](#Добавить-права-модератора)
* ```(administrator) DELETE /api/v1/user/<string:email>/moderator```
  * [Убрать права модератора.](#Убрать-права-модератора)

# Данные о запросах
## Публичные запросы
### Проверка соединения
```
GET /api/v1/ping
```
**Описание:**

Проверяет соединение с Rest API.
Возвращает простое сообщение "pong".

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

1

**Ответ:**
```javascript
{
  "msg": "pong"
}
```

## Запросы регистрации
### Создать новый аккаунт
```
POST /api/v1/register
```
**Описание:**

Запрос на создание нового аккаунта. 
Отправит письмо с подтверждением на почту, если такая почта существует. 
Иначе, выдаст ошибку.
В письме с подтверждением будет ссылка, перейдя по которой 
браузер отправит запрос на подтверждение почты с кодом из сообщения.

**Уровень доступа:**

Public

**Параметры:**
* email: string | обязательный
* password: string | обязательный

**Вес:** 

10

**Ответ:**
```javascript
{
  'msg': 'Verification is sent to {email}'
}
```

### Подтвердить регистрацию
```
GET /api/v1/register/verify/<string:verification_hash>
```
**Описание:**

Подтверждает регистрацию по коду {verification_hash}.
Ссылка с этим кодом присылается на почту пользователю:
./email_verification.html?code={verification_hash}

При желании, эту ссылку можно изменить в настройках сервера, 
в файле settings.json, в параметре "email_verification_link_base".

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Ответ:**
```javascript
{
  'msg': 'Email was succesfully confirmed.'
}
```

## Запросы пользователя
### Информация о текущем пользователе
```
GET /api/v1/user
```
**Описание:**

Возвращает словарь с данными о текущем пользователе.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

1

**Ответ:**
```javascript
{
  "avatar":"http://127.0.0.1:5000/image/user/default.jpg",
  "email":"example@gmail.com",
  "name":"Head Admin",
  "phone_number":null,
  "registration_date":"2020-02-24 00:50:24.262170",
  "type":"admin"
}

```

### Обновить данные текущего пользователя
```
PUT /api/v1/user
```
**Описание:**

Изменить параметры пользователя, такие как
номер телефона и/или имя.

**Уровень доступа:**

User

**Параметры:**
* phone: string
* name: string

**Вес:** 

2

**Ответ:**
```javascript
{
  "msg": "Data is edited successfully."
}
```

### Запрос на изменение пароля пользователя
```
PUT /api/v1/user/password
```
**Описание:**

Отправляет запрос на изменение пароля.
Подтверждение прийдет на почту пользователя с ссылкой,
по аналогии с подтверждением почты.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Подтвердить код изменения пароля
```
GET /api/v1/lots/password/verification/<string:code>
```
**Описание:**

Подтверждает изменение пароля по коду.
По аналогии с подтверждением почты, ссылка на файл, который 
сделает запрос автоматически, прийдет в сообщении на почту.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Восстановить пароль
```
GET /api/v1/user/restore/<string:email>
```
**Описание:**

Запрос на восстановление(сброс) пароля.
Подтверждение с кодом прийдет на почту, по аналогии
с подтверждением почты.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Подтвердить восстановление пароля
```
GET /api/v1/user/restore/verify/<string:code>
```
**Описание:**

По аналогии с двумя другими подтверждениями, 
подтверждает код, который прийдет на почту. 
После подтверждения, новый пароль будет выслан на почту.
Рекомендуется сразу поменять его в профиле.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Ссылка на аватар текущего пользователя
```
GET api/v1/user/avatar
```
**Описание:**

Возвращает ссылку на аватар текущего пользователя.
Если у него еще нет аватара, то вернется ссылка на
аватар по умолчанию.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Загрузить новый аватар
```
POST /api/v1/user/avatar
```
**Описание:**

Загружает аватар пользователя на сервер.
Если у пользователя уже есть аватар, то он перезапишется.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Удалить текущий аватар
```
DELETE /api/v1/user/avatar
```
**Описание:**

Удаляет текущий аватар пользователя, 
замещая его аватаром по умолчанию.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

## Лоты
### Общее

### Информация о доступных значениях различных полей лотов
```
GET /api/v1/lots/settings
```
**Описание:**

Возвращает значения параметров для лота.
Существует три типа: str, List[str], None.
В первом случае, это регулярное выражение.
Во втором, это список позможных значений.
В третьем это означает, что возможно 
произвольное строковое значение.
        
Все эти значения хранятся в файле
настроек сервера settings.json

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить все публичные лоты
```
GET /api/v1/lots
```
**Описание:**

Возвращает список лотов, 
которые доступны для публики.
Это те лоты, которые прошли модерацию и
еще не нашли своего спонсора.

Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Копия GET /api/v1/lots
```
GET/POST /api/v1/lots/approved
```
**Описание:**

Создает новый лот. Этот лот будет автоматически 
закреплен за текущим пользователем. По умолчанию,
сразу после создания, лот будет отправлен на модерацию,
где будет ожидать проверки.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Создать новый лот
```
POST /api/v1/lots
```
**Описание:**

Создает новый лот. Этот лот будет автоматически 
закреплен за текущим пользователем. По умолчанию,
сразу после создания, лот будет отправлен на модерацию,
где будет ожидать проверки.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить данные о лоте
```
GET /api/v1/lots/<int:id>
```
**Описание:**

Получить данные о конкретном лоте по его айди.
Лот возвращается стандартный словарь лота, как и в
любом списке лотов.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Обновить данные лота
```
PUT /api/v1/lots/<int:id>
```
**Описание:**

Изменить некоторые данные лота.
Изменять данные лота может только его создатель.
После изменения, если лот был подтвержден,
он снова станет неподтвержденным и отправится
на модерацию.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Восстановить удаленный лот
```
POST /api/v1/lots/<int:id>
```
**Описание:**

Если лот уже находится в архиве,
восстановит его. 
Эту операцию может делать только создатель лота.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Удалить лот
```
DELETE /api/v1/lots/<int:id>
```
**Описание:**

Переместить лот в архив.
Архивный лот можно позже удалить полностью
или восстановить.
Эту операцию может делать только создатель лота.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Полностью удалить лот
```
DELETE /api/v1/lots/personal/deleted/<int:lot_id>
```
**Описание:**

Удаляет лот, если он уже находится в архиве.
Эту операцию может делать только создатель лота.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список фотографий лота
```
GET /api/v1/lots/<int:id>/photos
```
**Описание:**

Возвращает список ссылок на фотографии лота по
его айди.

**Уровень доступа:**

Public

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Добавить лоту фотографию
```
POST /api/v1/lots/<int:id>/photos
```
**Описание:**

Добавляет новую фотографию лоту.
Это действие на подтвержденном лоте приведет
к его повторной модерации.
Эту операцию может делать только создатель лота.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Удалить фотографию лота
```
DELETE /api/v1/lots/<int:id>/photos/<int:photo_id>
```
**Описание:**

Удаляет фотографию лота по ее порядковому номеру.
Это действие на подтвержденном лоте приведет
к его повторной модерации.
Эту операцию может делать только создатель лота.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Добавить лот в избранное
```
PUT /api/v1/lots/favorites/<int:lot_id>
```
**Описание:**

Добавляет выбранный лот в список избранных лотов пользователя.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Удалить лот из избранных
```
DELETE /api/v1/lots/favorites/<int:lot_id>
```
**Описание:**

Удаляет выбранный лот из списка избранных лотов пользователя.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список избранных лотов
```
GET/POST /api/v1/lots/favorites
```
**Описание:**

Возвращает список избранных лотов пользователя.
        
Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список своих лотов, нашедших финансирование
```
GET/POST /api/v1/lots/personal/taken
```
**Описание:**

Возвращает список лотов пользователя, которые 
уже нашли финансирование.

Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список своих завершенных лотов
```
GET/POST /api/v1/lots/personal/finished
```
**Описание:**

Возвращает список завершенных лотов пользователя.
        
Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список своих удаленных лотов
```
GET/POST /api/v1/lots/personal/deleted
```
**Описание:**

Возвращает архив лотов пользователя.
        
Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Подписаться на лот
```
PUT /api/v1/lots/subscription/<int:id>
```
**Описание:**

Запросить у модерации подписку на лот.
Передается тип обратной связи - type (Email или PhoneCall)
и сообщение message, для модератора.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Убрать подписку на лот
```
DELETE /api/v1/lots/subscription/<int:id>
```
**Описание:**

Отменяет подписку на лот.
Не возможно отменить подписку, если ее уже подтвердили.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список лотов, на которые ты подписан
```
GET /api/v1/lots/subscription
```
**Описание:**

Возвращает список лотов, на которые ты подписан.
Подписки не обязательно будут подтвержденными.

Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Запросить гарантию клуба
```
PUT /api/v1/lots/personal/<int:lot_id>/request/guarantee
```
**Описание:**

Конкретное описание

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Запросить подтверждение обеспечения
```
PUT /api/v1/lots/personal/<int:lot_id>/request/verify_security
```
**Описание:**

Конкретное описание

**Уровень доступа:**

User

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

## Запросы модератора
### Подтвердить лот
```
PUT /api/v1/lots/<int:lot_id>/approve
```
**Описание:**

Подтверждает лот по айди.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Подтвердить проверенное обеспечение лота
```
PUT /api/v1/lots/<int:lot_id>/security
```
**Описание:**

Устанавливает у лота проверенное обеспечение.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Убрать проверенное обеспечение лота
```
DELETE /api/v1/lots/<int:lot_id>/security
```
**Описание:**

Убирает у лота проверенное обеспечение.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Установить гарантию клуба лоту
```
PUT /api/v1/lots/<int:lot_id>/guarantee
```
**Описание:**

Устанавливает лоту гарантию клуба.
Гарантия клуба это целое число от 0 до 100
включительно. Если это число 0, то считается,
что у лота нет гарантии.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Убрать гарантию клуба у лота
```
DELETE /api/v1/lots/<int:lot_id>/guarantee
```
**Описание:**

Убирает у лота гарантию клуба.
То есть, устанавливает ее значение равным 0.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список неподтвержденных лотов
```
GET /api/v1/lots/unapproved
```
**Описание:**

Возвращает список лотов, которые еще не были подтверждены.
        
Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список подтвержденных подписок
```
GET /api/v1/lots/subscription/approved
```
**Описание:**

Получить список подписок, которые подтвердил модератор,
но которые еще не являются завершенными.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список неподтвержденных подписок
```
GET /api/v1/lots/subscription/unapproved
```
**Описание:**

Получить список подписок, которые еще не были подтверждены.
В этот список не будут входить те подписки, которые отправлены
на лот, который уже нашел своего спонсора.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Отклонить неподтвержденный лот
```
DELETE /api/v1/lots/unapproved/<int:lot_id>
```
**Описание:**

Отклонить модерацию неподтвержденного лота.
Модератор должен отправить reason.
У владельца данного лота вернется эта причина, а лот
переместиться в архив автоматически.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список лотов, запросивших гарантию клуба
```
GET /api/v1/lots/requested/guarantee
```
**Описание:**

Возвращает список лотов, владельцы которых запросили гарантию клуба.

Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список лотов, запросивших проверку обеспечения
```
GET /api/v1/lots/requested/security_verification
```
**Описание:**

Возвращает список лотов, владельцы которых запросили гарантию клуба.

Как и в любом другом списке лотов, тут 
присутствует фильтрация.
Это означает, что используя метод POST 
(для некоторых запросов, означает что-то другое) 
можно отправить параметр "filter", в котором
нужно передать словарь, поддерживающий 
следующие значения:

"limit" - число лотов в списке, максимум 1000. 
По умолчанию - 1000.

"offset" - номер первого лота в списке 
(отступ от начала). По умолчанию - 0.

"order_by" - имя поля, по которому необходимо
сортировать список.

"order_type" - тип сортировки, "ASC" или "DESC".
По умолчанию - "ASC".

"show_only" - словарь, в котором ключи - имена полей,
по которым нужно делать фильтрацию. Поддерживаются
только те поля, которые имеют в настройках 
формат List[str]. Значение же - список строк, где
каждая строка - значение этого поля. В итоге запрос
вернет только те лоты, значения полей которых,
соответствуют данной фильтрации. То есть, для каждого
ключа, будут отфильтрованы те лоты, значения
соответствующего поля которого не находится в 
списке-значении.

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Подтвердить неподтвержденную подписку
```
GET /api/v1/lots/subscription/<string:id>/approve
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Снять подтверждение подписки
```
GET /api/v1/lots/subscription/<string:id>/unapprove
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Удалить неподтвержденную подписку
```
DELETE /api/v1/lots/subscription/<string:id>
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Закончить подтвержденную подписку
```
GET /api/v1/lots/subscription/<string:id>/finish
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Получить список архивных подписок
```
GET/POST /api/v1/lots/archive
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Посмотреть историю архивной подписки
```
GET /api/v1/lots/archive/<int:lot_id>
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Moderator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

## Запросы администратора
### Добавить права модератора
```
PUT /api/v1/user/<string:email>/moderator
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Administrator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```

### Убрать права модератора
```
DELETE /api/v1/user/<string:email>/moderator
```
**Описание:**

Конкретное описание

**Уровень доступа:**

Administrator

**Параметры:**

Отсутствуют

**Вес:** 

10

**Ответ:**
```javascript
{

}
```